{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://w3id.org/adaJSONLD/schema/3.0",
    "title": "Astromat Archive Product Metadata",
    "description": "Schema for JSON metadata documenting products in Astromat Data Archive (ADA). Each project consists of one or more data files and 0 to many supplemental files. Each file MUST have an associated YAML metadata file, with the same name, but '.yaml' as the file extension. Version 3.0 aligned with CDIF 2026 schema for DDI-CDI variable types and CSVW tabular data properties.",
    "type": "object",
    "allOf": [
        {"$ref": "../../schemaorgProperties/cdifMandatory/cdifMandatorySchema.json"},
        {"$ref": "../../schemaorgProperties/cdifOptional/cdifOptionalSchema.json"},
        {
            "type": "object",
            "properties": {
                "@type": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "enum": [
                            "schema:Dataset",
                            "schema:Product"
                        ]
                    }
                },
                "schema:additionalType": {
                    "type": "array",
                    "description": "Should have the ada product type and 'ada:DataDeliveryPackage'",
                    "items": {"type": "string"}
                },
                "submissionType": {"type": "string"},
                "schema:funding": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "@type": {
                                "type": "string",
                                "default": "schema:MonetaryGrant",
                                "const": "schema:MonetaryGrant"
                            },
                            "schema:identifier": {
                                "type": "string",
                                "description": "String that identifies a particular grant"
                            },
                            "schema:name": {
                                "type": "string",
                                "description": "Title of the grant"
                            },
                            "schema:funder": {
                                "anyOf": [
                                    {
                                        "type": "object",
                                        "properties": {
                                            "@id": {
                                                "type": "string",
                                                "description": "Identifier for an agent defined in metadata or externally"
                                            }
                                        }
                                    },
                                    {
                                        "type": "object",
                                        "properties": {
                                            "@type": {
                                                "type": "string",
                                                "const": "schema:Organization",
                                                "default": "schema:Organization"
                                            },
                                            "schema:additionalType": {
                                                "type": "array",
                                                "items": {
                                                    "enum": ["schema:FundingAgency"]
                                                }
                                            },
                                            "schema:name": {"type": "string"}
                                        },
                                        "required": [
                                            "@type",
                                            "schema:name"
                                        ]
                                    }
                                ]
                            }
                        }
                    }
                },
                "schema:identifier": {
                    "description": "Primary identifier for the dataset",
                    "anyOf": [
                        {
                            "type": "object",
                            "properties": {
                                "@type": {
                                    "type": "string",
                                    "const": "schema:PropertyValue",
                                    "default": "schema:PropertyValue"
                                },
                                "schema:propertyID": {
                                    "type": "string",
                                    "default": "https://registry.identifiers.org/registry/doi"
                                },
                                "schema:value": {"type": "string"},
                                "schema:url": {"type": "string"}
                            }
                        },
                        {"type": "string"}
                    ]
                },
                "schema:creator": {
                    "description": "Author or originator of intellectual content of dataset. Use the JSON-LD @list construct to preserve author order.",
                    "type": "object",
                    "properties": {
                        "@list": {
                            "type": "array",
                            "items": {
                                "anyOf": [
                                    {
                                        "type": "object",
                                        "properties": {
                                            "@id": {"type": "string"},
                                            "@type": {
                                                "type": "string",
                                                "const": "schema:Person",
                                                "default": "schema:Person"
                                            },
                                            "schema:name": {"type": "string"},
                                            "schema:alternateName": {"type": "string"},
                                            "schema:affiliation": {"type": "object"},
                                            "schema:description": {"type": "string"},
                                            "schema:identifier": {
                                                "anyOf": [
                                                    {"type": "object"},
                                                    {"type": "string"}
                                                ]
                                            },
                                            "schema:sameAs": {
                                                "type": "array",
                                                "items": {"type": "string"}
                                            }
                                        },
                                        "allOf": [
                                            {
                                                "required": ["@type"]
                                            },
                                            {
                                                "anyOf": [
                                                    {
                                                        "required": ["schema:name"]
                                                    },
                                                    {
                                                        "required": ["schema:identifier"]
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "object",
                                        "properties": {
                                            "@id": {"type": "string"},
                                            "@type": {
                                                "type": "string",
                                                "const": "schema:Organization",
                                                "default": "schema:Organization"
                                            },
                                            "schema:additionalType": {
                                                "type": "array",
                                                "items": {
                                                    "enum": ["schema:ResearchOrganization"]
                                                }
                                            },
                                            "schema:name": {"type": "string"}
                                        },
                                        "required": [
                                            "@type",
                                            "schema:name"
                                        ]
                                    }
                                ]
                            }
                        }
                    }
                },
                "schema:contributor": {
                    "description": "Other parties who played a role in production of dataset",
                    "type": "array",
                    "items": {
                        "anyOf": [
                            {"type": "string"},
                            {
                                "type": "object",
                                "properties": {
                                    "@id": {"type": "string"}
                                }
                            },
                            {
                                "type": "object",
                                "properties": {
                                    "@type": {
                                        "type": "string",
                                        "const": "schema:Person"
                                    },
                                    "schema:name": {"type": "string"}
                                },
                                "required": [
                                    "@type",
                                    "schema:name"
                                ]
                            },
                            {
                                "type": "object",
                                "properties": {
                                    "@type": {
                                        "type": "string",
                                        "const": "schema:Organization",
                                        "default": "schema:Organization"
                                    },
                                    "schema:name": {"type": "string"}
                                },
                                "required": [
                                    "@type",
                                    "schema:name"
                                ]
                            },
                            {
                                "type": "object",
                                "description": "Role-based contributor",
                                "properties": {
                                    "@type": {
                                        "type": "string",
                                        "default": "schema:Role",
                                        "const": "schema:Role"
                                    },
                                    "schema:roleName": {"type": "string"},
                                    "schema:contributor": {
                                        "oneOf": [
                                            {"type": "string"},
                                            {
                                                "type": "object",
                                                "properties": {
                                                    "@id": {
                                                        "type": "string",
                                                        "description": "a identifier for an agent defined in this metadata, or externally; must be dereferenceable"
                                                    }
                                                }
                                            },
                                            {
                                                "type": "object",
                                                "properties": {
                                                    "@type": {
                                                        "type": "string",
                                                        "const": "schema:Person"
                                                    },
                                                    "schema:name": {"type": "string"}
                                                },
                                                "required": [
                                                    "@type",
                                                    "schema:name"
                                                ]
                                            },
                                            {
                                                "type": "object",
                                                "properties": {
                                                    "@type": {
                                                        "type": "string",
                                                        "const": "schema:Organization"
                                                    },
                                                    "schema:name": {"type": "string"}
                                                },
                                                "required": [
                                                    "@type",
                                                    "schema:name"
                                                ]
                                            }
                                        ]
                                    }
                                }
                            }
                        ]
                    }
                },
                "schema:license": {
                    "description": "Legal statement of conditions for use and access",
                    "type": "array",
                    "minItems": 0,
                    "items": {
                        "anyOf": [
                            {"type": "string"},
                            {"$ref": "../../adaProperties/creativeWork/creativeWorkSchema.json"}
                        ]
                    }
                },
                "schema:relatedLink": {
                    "type": "array",
                    "description": "Links to related resources at the product level",
                    "items": {
                        "type": "object",
                        "properties": {
                            "@type": {
                                "type": "string",
                                "const": "schema:LinkRole"
                            },
                            "schema:linkRelationship": {"type": "string"},
                            "schema:target": {
                                "type": "object",
                                "properties": {
                                    "@type": {
                                        "type": "string",
                                        "const": "schema:EntryPoint"
                                    },
                                    "schema:encodingFormat": {"type": "string"},
                                    "schema:name": {"type": "string"},
                                    "schema:url": {"type": "string"}
                                }
                            }
                        }
                    }
                },
                "schema:creativeWorkStatus": {"type": "string"},
                "schema:measurementTechnique": {
                    "type": "object",
                    "description": "Text description of the measurement method",
                    "properties": {
                        "@type": {"const": "schema:DefinedTerm"},
                        "schema:name": {"type": "string"},
                        "schema:identifier": {"type": "string"}
                    }
                },
                "prov:wasGeneratedBy": {
                    "type": "array",
                    "description": "Analysis events that generated this product",
                    "items": {
                        "type": "object",
                        "properties": {
                            "@type": {
                                "description": "Include 'prov:Activity' and 'schema:Event'",
                                "type": "array",
                                "items": {"type": "string"},
                                "allOf": [
                                    {
                                        "contains": {"const": "prov:Activity"}
                                    },
                                    {
                                        "contains": {"const": "schema:Event"}
                                    }
                                ]
                            },
                            "prov:used": {
                                "type": "array",
                                "description": "Instruments used in the analysis",
                                "items": {"$ref": "../../adaProperties/instrument/instrumentSchema.json"}
                            },
                            "schema:location": {"$ref": "../../adaProperties/laboratory/laboratorySchema.json"},
                            "schema:mainEntity": {
                                "type": "array",
                                "description": "Samples analyzed",
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "@type": {
                                            "const": [
                                                "schema:Thing",
                                                "https://w3id.org/isample/vocabulary/materialsampleobjecttype/materialsample"
                                            ]
                                        },
                                        "schema:additionalType": {
                                            "type": "array",
                                            "items": {"type": "string"}
                                        },
                                        "schema:identifier": {
                                            "type": "array",
                                            "items": {"type": "string"}
                                        }
                                    }
                                }
                            },
                            "schema:identifier": {
                                "description": "Identifier for the analysis event (sessionID)",
                                "type": "string"
                            },
                            "schema:startDate": {"type": "string"}
                        },
                        "required": ["prov:used"]
                    }
                },
                "schema:variableMeasured": {
                    "description": "What does the dataset measure? Define the variables here at the conceptual level; the physical implementation details are in the data structure. Requires dual typing with schema:PropertyValue and cdi:InstanceVariable per CDIF 2026.",
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "@id": {
                                "type": "string",
                                "description": "Identifier for this variable, used to link from physical mappings in distributions."
                            },
                            "@type": {
                                "type": "array",
                                "items": {
                                    "type": "string",
                                    "enum": [
                                        "schema:PropertyValue",
                                        "cdi:InstanceVariable"
                                    ]
                                },
                                "minItems": 2
                            },
                            "schema:description": {
                                "type": "string",
                                "minLength": 10
                            },
                            "schema:name": {
                                "description": "The name as it typically appears in a dataset",
                                "type": "string",
                                "minLength": 5
                            },
                            "schema:alternateName": {
                                "type": "array",
                                "items": {
                                    "type": "string",
                                    "description": "Human intelligible name for variable that conveys semantics"
                                }
                            },
                            "schema:propertyID": {
                                "description": "Ideally a resolvable URI for a property concept",
                                "type": "array",
                                "items": {
                                    "anyOf": [
                                        {"type": "string"},
                                        {
                                            "type": "object",
                                            "properties": {
                                                "@id": {"type": "string"}
                                            }
                                        },
                                        {
                                            "type": "object",
                                            "properties": {
                                                "@type": {
                                                    "type": "string",
                                                    "const": "schema:DefinedTerm"
                                                },
                                                "schema:name": {"type": "string"},
                                                "schema:identifier": {"type": "object"},
                                                "schema:inDefinedTermSet": {"type": "string"},
                                                "schema:termCode": {"type": "string"}
                                            },
                                            "required": [
                                                "@type",
                                                "schema:name"
                                            ]
                                        }
                                    ]
                                }
                            },
                            "schema:measurementTechnique": {
                                "anyOf": [
                                    {"type": "string"},
                                    {
                                        "type": "object",
                                        "properties": {
                                            "@id": {"type": "string"}
                                        }
                                    },
                                    {
                                        "type": "object",
                                        "properties": {
                                            "@type": {
                                                "type": "string",
                                                "const": "schema:DefinedTerm"
                                            },
                                            "schema:name": {"type": "string"}
                                        },
                                        "required": [
                                            "@type",
                                            "schema:name"
                                        ]
                                    }
                                ]
                            },
                            "schema:unitText": {"type": "string"},
                            "schema:unitCode": {
                                "anyOf": [
                                    {"type": "string"},
                                    {
                                        "type": "object",
                                        "properties": {
                                            "@id": {"type": "string"}
                                        }
                                    },
                                    {
                                        "type": "object",
                                        "properties": {
                                            "@type": {
                                                "type": "string",
                                                "const": "schema:DefinedTerm"
                                            },
                                            "schema:name": {"type": "string"}
                                        },
                                        "required": [
                                            "@type",
                                            "schema:name"
                                        ]
                                    }
                                ]
                            },
                            "schema:minValue": {"type": "number"},
                            "schema:maxValue": {"type": "number"},
                            "schema:url": {
                                "type": "string",
                                "format": "uri"
                            },
                            "cdi:intendedDataType": {"type": "string"},
                            "cdi:role": {
                                "type": "string",
                                "description": "The role of the variable: MeasureComponent, AttributeComponent, DimensionComponent, IdentifierComponent."
                            },
                            "cdi:describedUnitOfMeasure": {
                                "type": "object",
                                "properties": {
                                    "@type": {
                                        "type": "string",
                                        "const": "schema:DefinedTerm"
                                    },
                                    "schema:name": {"type": "string"}
                                },
                                "required": [
                                    "@type",
                                    "schema:name"
                                ]
                            },
                            "cdi:simpleUnitOfMeasure": {"type": "string"},
                            "cdi:uses": {
                                "type": "array",
                                "items": {
                                    "anyOf": [
                                        {"type": "string"},
                                        {
                                            "type": "object",
                                            "properties": {
                                                "@id": {"type": "string"}
                                            }
                                        },
                                        {
                                            "type": "object",
                                            "properties": {
                                                "@type": {
                                                    "type": "string",
                                                    "const": "schema:DefinedTerm"
                                                },
                                                "schema:name": {"type": "string"}
                                            },
                                            "required": [
                                                "@type",
                                                "schema:name"
                                            ]
                                        }
                                    ]
                                }
                            }
                        },
                        "required": [
                            "@id",
                            "@type",
                            "schema:description",
                            "schema:name"
                        ]
                    }
                },
                "schema:distribution": {
                    "type": "array",
                    "description": "Access options for the dataset. Each distribution item is expected to be a single file or an archive containing multiple files described in hasPart.",
                    "items": {
                        "anyOf": [
                            {
                                "allOf": [
                                    {"$ref": "../../adaProperties/files/filesSchema.json"},
                                    {
                                        "type": "object",
                                        "description": "Single file distribution.",
                                        "properties": {
                                            "@type": {
                                                "type": "array",
                                                "items": {
                                                    "type": "string",
                                                    "enum": ["schema:DataDownload"]
                                                },
                                                "minItems": 1
                                            }
                                        }
                                    }
                                ]
                            },
                            {
                                "allOf": [
                                    {"$ref": "../../adaProperties/files/filesSchema.json"},
                                    {
                                        "type": "object",
                                        "description": "Archive file with parts.",
                                        "properties": {
                                            "@type": {
                                                "type": "array",
                                                "items": {
                                                    "type": "string",
                                                    "enum": ["schema:DataDownload"]
                                                },
                                                "minItems": 1
                                            },
                                            "schema:provider": {
                                                "type": "array",
                                                "description": "Party who maintains this particular distribution option.",
                                                "items": {
                                                    "anyOf": [
                                                        {
                                                            "type": "object",
                                                            "properties": {
                                                                "@type": {
                                                                    "type": "string",
                                                                    "const": "schema:Person"
                                                                },
                                                                "schema:name": {"type": "string"}
                                                            },
                                                            "required": [
                                                                "@type",
                                                                "schema:name"
                                                            ]
                                                        },
                                                        {
                                                            "type": "object",
                                                            "properties": {
                                                                "@type": {
                                                                    "type": "string",
                                                                    "const": "schema:Organization",
                                                                    "default": "schema:Organization"
                                                                },
                                                                "schema:name": {"type": "string"}
                                                            },
                                                            "required": [
                                                                "@type",
                                                                "schema:name"
                                                            ]
                                                        }
                                                    ]
                                                }
                                            },
                                            "schema:additionalType": {
                                                "type": "array",
                                                "description": "Identify the package scheme, e.g. NASA PDS bundle, RO-CRATE, Bagit",
                                                "items": {"type": "string"}
                                            },
                                            "schema:hasPart": {
                                                "type": "array",
                                                "description": "Array describing the files in the zip archive.",
                                                "items": {
                                                    "allOf": [
                                                        {"$ref": "../../adaProperties/files/filesSchema.json"},
                                                        {
                                                            "type": "object",
                                                            "properties": {
                                                                "@type": {
                                                                    "type": "array",
                                                                    "items": {"type": "string"},
                                                                    "not": {
                                                                        "contains": {"const": "schema:DataDownload"}
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    ]
                                                }
                                            }
                                        }
                                    }
                                ]
                            },
                            {
                                "type": "object",
                                "description": "Web API distribution with file result. The API provides access to data that can also be described as DataDownload file(s).",
                                "properties": {
                                    "@type": {
                                        "type": "array",
                                        "items": {
                                            "type": "string",
                                            "enum": ["schema:WebAPI"]
                                        },
                                        "minItems": 1
                                    },
                                    "schema:name": {"type": "string"},
                                    "schema:description": {"type": "string"},
                                    "schema:serviceType": {
                                        "anyOf": [
                                            {"type": "string"},
                                            {
                                                "type": "object",
                                                "properties": {
                                                    "@type": {
                                                        "type": "string",
                                                        "const": "schema:DefinedTerm"
                                                    },
                                                    "schema:name": {"type": "string"}
                                                },
                                                "required": [
                                                    "@type",
                                                    "schema:name"
                                                ]
                                            }
                                        ]
                                    },
                                    "schema:documentation": {
                                        "oneOf": [
                                            {"type": "string"},
                                            {
                                                "type": "object",
                                                "properties": {
                                                    "@type": {
                                                        "type": "string",
                                                        "const": "schema:CreativeWork"
                                                    },
                                                    "schema:name": {"type": "string"},
                                                    "schema:url": {
                                                        "type": "string",
                                                        "format": "uri"
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    "schema:potentialAction": {
                                        "type": "array",
                                        "description": "Actions that can be invoked via the API.",
                                        "items": {"$ref": "../../schemaorgProperties/action/actionSchema.json"}
                                    },
                                    "schema:result": {
                                        "description": "The file(s) that result from invoking this API. Reuses the same single-file or archive-with-hasPart structure.",
                                        "oneOf": [
                                            {
                                                "allOf": [
                                                    {"$ref": "../../adaProperties/files/filesSchema.json"},
                                                    {
                                                        "type": "object",
                                                        "description": "Single file result.",
                                                        "properties": {
                                                            "@type": {
                                                                "type": "array",
                                                                "items": {"type": "string"},
                                                                "contains": {"const": "schema:DataDownload"},
                                                                "minItems": 1
                                                            }
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "allOf": [
                                                    {"$ref": "../../adaProperties/files/filesSchema.json"},
                                                    {
                                                        "type": "object",
                                                        "description": "Archive file result with parts.",
                                                        "properties": {
                                                            "@type": {
                                                                "type": "array",
                                                                "items": {"type": "string"},
                                                                "contains": {"const": "schema:DataDownload"},
                                                                "minItems": 1
                                                            },
                                                            "schema:hasPart": {
                                                                "type": "array",
                                                                "description": "Files within the archive result.",
                                                                "items": {
                                                                    "allOf": [
                                                                        {"$ref": "../../adaProperties/files/filesSchema.json"},
                                                                        {
                                                                            "type": "object",
                                                                            "properties": {
                                                                                "@type": {
                                                                                    "type": "array",
                                                                                    "items": {"type": "string"},
                                                                                    "not": {
                                                                                        "contains": {"const": "schema:DataDownload"}
                                                                                    }
                                                                                }
                                                                            }
                                                                        }
                                                                    ]
                                                                }
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                },
                                "required": [
                                    "@type",
                                    "schema:serviceType",
                                    "schema:potentialAction"
                                ]
                            }
                        ]
                    }
                },
                "schema:subjectOf": {
                    "type": "object",
                    "description": "Metadata record about this dataset",
                    "properties": {
                        "@type": {
                            "type": "string",
                            "const": "schema:Dataset"
                        },
                        "@id": {
                            "type": "string",
                            "description": "Identifier for the metadata record"
                        },
                        "schema:about": {
                            "type": "object",
                            "properties": {
                                "@id": {"type": "string"}
                            }
                        },
                        "dcterms:conformsTo": {
                            "type": "array",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "@id": {
                                        "type": "string",
                                        "description": "URI for specifications that this metadata record conforms to. Minimally should specify URI for CDIF discovery profile."
                                    }
                                }
                            }
                        },
                        "schema:maintainer": {
                            "anyOf": [
                                {
                                    "type": "object",
                                    "properties": {
                                        "@type": {
                                            "type": "string",
                                            "const": "schema:Person"
                                        },
                                        "schema:name": {"type": "string"}
                                    },
                                    "required": [
                                        "@type",
                                        "schema:name"
                                    ]
                                },
                                {
                                    "type": "object",
                                    "properties": {
                                        "@type": {
                                            "type": "string",
                                            "const": "schema:Organization",
                                            "default": "schema:Organization"
                                        },
                                        "schema:name": {"type": "string"}
                                    },
                                    "required": [
                                        "@type",
                                        "schema:name"
                                    ]
                                }
                            ]
                        },
                        "schema:sdDatePublished": {
                            "description": "Date of most recent update to the metadata content",
                            "type": "string",
                            "format": "date-time"
                        },
                        "schema:includedInDataCatalog": {
                            "type": "object",
                            "properties": {
                                "@id": {"type": "string"},
                                "@type": {
                                    "type": "string",
                                    "default": "schema:DataCatalog",
                                    "const": "schema:DataCatalog"
                                },
                                "schema:name": {"type": "string"},
                                "schema:url": {"type": "string"},
                                "schema:identifier": {
                                    "type": "object",
                                    "properties": {
                                        "@type": {
                                            "type": "string",
                                            "const": "schema:PropertyValue"
                                        },
                                        "schema:propertyID": {"type": "string"},
                                        "schema:value": {"type": "string"},
                                        "schema:url": {"type": "string"}
                                    }
                                }
                            }
                        }
                    },
                    "required": [
                        "schema:about",
                        "dcterms:conformsTo",
                        "@type",
                        "@id"
                    ]
                }
            }
        }
    ]
}